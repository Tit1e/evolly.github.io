<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 一些工作中常用到的代码 · I'm Tit1e</title><meta name="description" content="一些工作中常用到的代码 - Tit1e"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="I'm Tit1e"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">一些工作中常用到的代码</h1><div class="post-info">2017年5月14日</div><div class="post-content"><p>很久没有写博客了，回原来的公司后就基本上没有更新了，到现在也快两个月了。这个博客其实很早前久应该写了，然后一直拖拖拖拖到现在。之前我全部记在了bear中，现在搬到博客上来，后续有更新就在现在基础上接着更新。其实不光涉及到工作中经常用的，还有一些经常是平时折腾的时候记下来怕日后忘记的。</p>
<p><strong>因为公司业务基本用的是jQuery，所以这里用到的代码基本上是基于jQuery。</strong></p>
<h3 id="iframe动态改变高度"><a href="#iframe动态改变高度" class="headerlink" title="iframe动态改变高度"></a>iframe动态改变高度</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//页面加载时获取iframe高度</span></div><div class="line">$(<span class="string">"#iframepage"</span>).on(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> mainheight = $(<span class="keyword">this</span>).contents().find(<span class="string">"body"</span>).height() + <span class="number">30</span>;</div><div class="line">    $(<span class="keyword">this</span>).height(mainheight);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//动态改变iframe高度</span></div><div class="line">setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> mainheight = $(<span class="string">"#iframepage"</span>).contents().find(<span class="string">"body"</span>).height() + <span class="number">30</span>;</div><div class="line">    $(<span class="string">"#iframepage"</span>).height(mainheight);</div><div class="line">&#125;, <span class="number">200</span>);</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="滚动条到底部自动加载数据"><a href="#滚动条到底部自动加载数据" class="headerlink" title="滚动条到底部自动加载数据"></a>滚动条到底部自动加载数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//滚动条到底部加载</span></div><div class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    ajaxFlag = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">var</span> page = <span class="number">10</span>;</div><div class="line">    <span class="keyword">var</span> num = page;</div><div class="line">    $(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> scrollTop = $(<span class="keyword">this</span>).scrollTop();                             <span class="comment">// 滚动条距离顶部的高度</span></div><div class="line">        <span class="keyword">var</span> scrollHeight = $(<span class="built_in">document</span>).height();                          <span class="comment">// 当前页面的总高度</span></div><div class="line">        <span class="keyword">var</span> windowHeight = $(<span class="keyword">this</span>).height();                              <span class="comment">// 当前可视的页面高度</span></div><div class="line">        <span class="keyword">var</span> expectHeight = <span class="number">0</span>;                                               <span class="comment">// 预加载距离</span></div><div class="line">        <span class="keyword">if</span> (scrollTop + windowHeight &gt;= scrollHeight - expectHeight) &#123;    <span class="comment">// 距离顶部+当前高度 &gt;=文档总高度 即代表滑动到底部</span></div><div class="line">            <span class="comment">//code....</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="获取url中的参数"><a href="#获取url中的参数" class="headerlink" title="获取url中的参数"></a>获取url中的参数</h3><p><em>公司后端用的thinkphp，所以获取参数直接用TP的I方法就可以，上次无意间搜到了，就顺便存了</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQueryString</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|&amp;)"</span> + name + <span class="string">"=([^&amp;]*)(&amp;|$)"</span>, <span class="string">"i"</span>);</div><div class="line">    <span class="keyword">var</span> r = <span class="built_in">window</span>.location.search.substr(<span class="number">1</span>).match(reg);</div><div class="line">    <span class="keyword">if</span> (r != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]); <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="判断单选或复选框是否被选中以及改变选中状态"><a href="#判断单选或复选框是否被选中以及改变选中状态" class="headerlink" title="判断单选或复选框是否被选中以及改变选中状态"></a>判断单选或复选框是否被选中以及改变选中状态</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($(<span class="keyword">this</span>).find(<span class="string">'input'</span>).prop(<span class="string">"checked"</span>)) &#123;</div><div class="line">    $(<span class="keyword">this</span>).find(<span class="string">'input'</span>).removeAttr(<span class="string">'checked'</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    $(<span class="keyword">this</span>).find(<span class="string">'input'</span>).attr(<span class="string">"checked"</span>, <span class="string">"checked"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="用阴影实现遮罩"><a href="#用阴影实现遮罩" class="headerlink" title="用阴影实现遮罩"></a>用阴影实现遮罩</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">box-shadow</span>: <span class="selector-tag">inset</span> 0 0 20<span class="selector-tag">px</span> 1<span class="selector-tag">px</span>, 0 0 5<span class="selector-tag">px</span> 2000<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.8</span>);</div></pre></td></tr></table></figure>
<h3 id="实时监听输入框变化"><a href="#实时监听输入框变化" class="headerlink" title="实时监听输入框变化"></a>实时监听输入框变化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#media_name'</span>).on(<span class="string">'input propertychange'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">   <span class="comment">//code.....</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="去除chrome表单黄色背景"><a href="#去除chrome表单黄色背景" class="headerlink" title="去除chrome表单黄色背景"></a>去除chrome表单黄色背景</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-webkit-autofill</span>, </div><div class="line"><span class="selector-tag">textarea</span><span class="selector-pseudo">:-webkit-autofill</span>, </div><div class="line"><span class="selector-tag">select</span><span class="selector-pseudo">:-webkit-autofill</span> &#123; </div><div class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1000px</span> white inset; </div><div class="line">&#125;</div><div class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=text]</span><span class="selector-pseudo">:focus</span>, <span class="selector-tag">input</span><span class="selector-attr">[type=password]</span><span class="selector-pseudo">:focus</span>, <span class="selector-tag">textarea</span><span class="selector-pseudo">:focus</span> &#123;</div><div class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1000px</span> white inset; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ThinkPHP时间戳格式化"><a href="#ThinkPHP时间戳格式化" class="headerlink" title="ThinkPHP时间戳格式化"></a>ThinkPHP时间戳格式化</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//如果在Action里 </span></div><div class="line">$time = date(<span class="string">"Y-m-d"</span>, $time);</div><div class="line"><span class="comment">//如果在模板里 </span></div><div class="line">&#123;$time|date=<span class="string">'Y-m-d'</span>,<span class="comment">###&#125;</span></div></pre></td></tr></table></figure>
<h3 id="ThinkPHP去掉url中的index-php"><a href="#ThinkPHP去掉url中的index-php" class="headerlink" title="ThinkPHP去掉url中的index.php"></a>ThinkPHP去掉url中的index.php</h3><p>在应用的根目录下面新建一个 .htaccess 文件(linux环境下)。在文件里面加入如下代码：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;IfModule mod_rewrite.c&gt;</span></div><div class="line"><span class="attribute"><span class="nomarkup">RewriteEngine</span></span> <span class="literal">on</span></div><div class="line"><span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-d</div><div class="line"><span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-f</div><div class="line"><span class="attribute"><span class="nomarkup">RewriteRule</span></span> ^(.*)$ index.php/<span class="number">$1</span><span class="meta"> [QSA,PT,L]</span></div><div class="line"><span class="section">&lt;/IfModule&gt;</span></div></pre></td></tr></table></figure></p>
<p>其实以上就已经实现了去除 url 中的 index.php 字符直接访问应用了。但是仅仅以上两步操作还会出现的一个问题就是 thinkphp 的常量 <strong>URL</strong> 中还是会自动带上 index.php 这段字符串，彻底解决这个问题的办法是在项目的配置文件里加上如一条如下配置：<code>&#39;URL_MODEL&#39;=&gt;&#39;2&#39;</code></p>
<h3 id="vue-for循环，把内容填充到-href，src中"><a href="#vue-for循环，把内容填充到-href，src中" class="headerlink" title="vue for循环，把内容填充到 href，src中"></a>vue for循环，把内容填充到 href，src中</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">:href=<span class="string">'list.href'</span></span></div><div class="line"><span class="symbol">:src=<span class="string">'list.src'</span></span></div></pre></td></tr></table></figure>
<h3 id="首行缩进css"><a href="#首行缩进css" class="headerlink" title="首行缩进css"></a>首行缩进css</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">text-indent</span><span class="selector-pseudo">:2em</span>;</div></pre></td></tr></table></figure>
<h3 id="iphone动态加载元素单击无效问题"><a href="#iphone动态加载元素单击无效问题" class="headerlink" title="iphone动态加载元素单击无效问题"></a>iphone动态加载元素单击无效问题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#list'</span>).delegate(<span class="string">'.tbody'</span>, <span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    $(<span class="string">'#loading'</span>).show();</div><div class="line">    location.href = $(<span class="keyword">this</span>).attr(<span class="string">'data'</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="去除移动端点击半透明感遮罩"><a href="#去除移动端点击半透明感遮罩" class="headerlink" title="去除移动端点击半透明感遮罩"></a>去除移动端点击半透明感遮罩</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">-webkit-tap-highlight-color</span>: <span class="selector-tag">rgba</span>(0,0,0,0);</div></pre></td></tr></table></figure>
<h3 id="图片和文字垂直水平居中"><a href="#图片和文字垂直水平居中" class="headerlink" title="图片和文字垂直水平居中"></a>图片和文字垂直水平居中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#add_supplier</span> &#123;</div><div class="line">    <span class="attribute">line-height</span>: <span class="number">2rem</span>;</div><div class="line">    <span class="attribute">font-size</span>: <span class="number">1.2rem</span><span class="meta">!important</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-id">#add_supplier</span>&gt;<span class="selector-tag">div</span> &#123;</div><div class="line">    <span class="attribute">display</span>: table;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-id">#add_supplier</span> <span class="selector-tag">span</span> &#123;</div><div class="line">    <span class="attribute">color</span>: <span class="number">#00AC5A</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-id">#add_supplier</span> <span class="selector-tag">img</span> &#123;</div><div class="line">    <span class="attribute">height</span>: <span class="number">50%</span>;</div><div class="line">    <span class="attribute">float</span>: left;</div><div class="line">    <span class="attribute">margin-right</span>: <span class="number">0.2rem</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">"add_supplier"</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"Public/img/company/add.png"</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">span</span>&gt;</span>添加供应商信息<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="ThinkPHP用法"><a href="#ThinkPHP用法" class="headerlink" title="ThinkPHP用法"></a>ThinkPHP<eq>用法</eq></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//name中不用加$</span></div><div class="line">&lt;eq name=<span class="string">"Think.get.pm"</span> value=<span class="string">"1"</span>&gt;checked&lt;/eq&gt;</div></pre></td></tr></table></figure>
<p>第一次大概就这么点，其他的之后会继续添加。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/03/07/26.jsNote3/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">Tit1e</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>